<!DOCTYPE html>
<html>

<head>
    <title>Google Docs API Example</title>
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        var CLIENT_ID = '953384927834-r4p4tg4p8hd10r8lbrk992ovpsvv63si.apps.googleusercontent.com';
        var API_KEY = 'AIzaSyBpaHXFrurTVaUeOGczuGPinhtvv7PqhbQ';
        var DISCOVERY_DOCS = ["https://docs.googleapis.com/$discovery/rest?version=v1"];
        var SCOPES = "https://www.googleapis.com/auth/documents";

        function handleClientLoad() {
            gapi.load('client:auth2', initClient);
        }

        function initClient() {
            gapi.client.init({
                apiKey: API_KEY,
                clientId: CLIENT_ID,
                discoveryDocs: DISCOVERY_DOCS,
                scope: SCOPES
            }).then(function() {
                gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
                updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
            }, function(error) {
                console.error(JSON.stringify(error, null, 2));
            });
        }

        function updateSigninStatus(isSignedIn) {
            if (isSignedIn) {
                document.getElementById('saveButton').style.display = 'block';
            } else {
                document.getElementById('saveButton').style.display = 'none';
            }
        }

        function handleSignInClick(event) {
            gapi.auth2.getAuthInstance().signIn();
        }

        function handleSignOutClick(event) {
            gapi.auth2.getAuthInstance().signOut();
        }

        function saveTextToGoogleDoc() {
            var textData = document.getElementById('textData').value;
            var documentId = '1JrgsKwexHeYBn7OdejHk_nx9r5Vith_UHbt51Jb7i4Q';

            gapi.client.docs.documents.batchUpdate({
                documentId: documentId,
                requests: [{
                    insertText: {
                        location: {
                            index: 1
                        },
                        text: textData
                    }
                }]
            }).then(function(response) {
                console.log(response);
                alert('Text saved successfully!');
            }, function(error) {
                console.error(JSON.stringify(error, null, 2));
            });
        }
    </script>
    <style>
        button {
            background-color: #000000cf;
            color: #fff;
            padding: 10;
            box-shadow: 2px 1px 10px #fff;
            border-radius: 10px;
            margin: 10;
            text-shadow: 2px 3px 5px #f10707;

        }
    </style>
</head>

<body onload="handleClientLoad()">
    <h1>Save Text to Google Docs</h1>
    <textarea id="textData" rows="10" cols="30"></textarea><br>
    <button id="authorizeButton" onclick="handleSignInClick()">Authorize</button>
    <button id="signoutButton" onclick="handleSignOutClick()">Sign Out</button>
    <button id="saveButton" style="display:none;" onclick="saveTextToGoogleDoc()">Save to Google Docs</button>
</body>

</html>
